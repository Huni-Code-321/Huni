<!doctype html>

<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Einfacher Taschenrechner</title>
  <style>
    :root{font-family: Inter, system-ui, Arial;}
    body{display:flex;align-items:center;justify-content:center;height:100vh;background:#0f172a;color:#e6eef8;margin:0}
    .calc{width:340px;background:linear-gradient(180deg,#0b1220,#0f1b2b);border-radius:16px;padding:18px;box-shadow:0 10px 30px rgba(2,6,23,.6)}
    .display{height:72px;background:rgba(255,255,255,0.03);border-radius:10px;padding:12px;display:flex;flex-direction:column;justify-content:center;align-items:flex-end;box-sizing:border-box;overflow:auto}
    .expr{font-size:14px;opacity:0.7}
    .result{font-size:28px;font-weight:600}
    .keys{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:14px}
    button{height:58px;border-radius:10px;border:0;font-size:18px;background:rgba(255,255,255,0.03);color:inherit;cursor:pointer;box-shadow:inset 0 -2px 0 rgba(0,0,0,.25)}
    button.op{background:rgba(255,255,255,0.04)}
    button.equal{grid-column:span(2;background:linear-gradient(90deg,#06b6d4,#3b82f6);color:white}
    button.wide{grid-column:span(2}
    .muted{opacity:0.75;font-size:13px}
    @media (max-width:380px){.calc{width:92vw}}
  </style>
</head>
<body>
  <div class="calc" role="application" aria-label="Taschenrechner">
    <div class="display" id="display">
      <div class="expr" id="expr">0</div>
      <div class="result" id="result">0</div>
    </div><div class="keys" id="keys">
  <button data-action="clear" class="muted">C</button>
  <button data-action="back" class="muted">⌫</button>
  <button data-action="paren">( )</button>
  <button data-value="/" class="op">÷</button>

  <button data-value="7">7</button>
  <button data-value="8">8</button>
  <button data-value="9">9</button>
  <button data-value="*" class="op">×</button>

  <button data-value="4">4</button>
  <button data-value="5">5</button>
  <button data-value="6">6</button>
  <button data-value="-" class="op">−</button>

  <button data-value="1">1</button>
  <button data-value="2">2</button>
  <button data-value="3">3</button>
  <button data-value="+" class="op">+</button>

  <button data-value="0" class="wide">0</button>
  <button data-value="." >.</button>
  <button data-action="equals" class="equal">=</button>
</div>
<p style="margin:10px 0 0;font-size:12px;opacity:0.8">Tastatur: Zahlen, + - * /, Enter = auswerten, Backspace Löschen</p>

  </div>  <script>
    (function(){
      const exprEl = document.getElementById('expr');
      const resultEl = document.getElementById('result');
      const keys = document.getElementById('keys');

      let expression = '';

      function render(){
        exprEl.textContent = expression || '0';
        try{
          const val = safeEval(expression);
          resultEl.textContent = (val === undefined || expression==='') ? '0' : String(val);
        }catch(e){
          resultEl.textContent = 'Fehler';
        }
      }

      // Allow only safe characters
      const SAFE_RE = /^[0-9+\-*/().\s]*$/;

      function safeEval(s){
        if(!s || !SAFE_RE.test(s)) throw new Error('unsicherer ausdruck');
        // convert common symbols
        s = s.replace(/×/g,'*').replace(/÷/g,'/').replace(/−/g,'-');
        // prevent consecutive operators like "++" at start: that's fine for JS but we keep it simple
        // Evaluate using Function (local) — fine for local calculator UI but don't use with untrusted remote input
        const fn = new Function('return (' + s + ')');
        return Number(fn());
      }

      keys.addEventListener('click', e=>{
        const b = e.target.closest('button');
        if(!b) return;
        const val = b.getAttribute('data-value');
        const action = b.getAttribute('data-action');

        if(val){
          // append value
          expression += val;
        }else if(action){
          if(action==='clear'){ expression=''; }
          else if(action==='back'){ expression = expression.slice(0,-1); }
          else if(action==='paren'){
            // simple smart paren: add '(' if more opens needed, else ')'
            const open = (expression.match(//g)||[]).length;
            const close = (expression.match(//g)||[]).length;
            expression += (open===close) ? '(' : ')';
          }
          else if(action==='equals'){
            try{ expression = String(safeEval(expression)); }catch(e){ expression = ''; alert('Ungültiger Ausdruck'); }
          }
        }
        render();
      });

      // keyboard support
      window.addEventListener('keydown', ev=>{
        if(ev.key === 'Enter'){
          ev.preventDefault();
          try{ expression = String(safeEval(expression)); }catch(e){ alert('Ungültiger Ausdruck'); expression=''; }
          render();
          return;
        }
        if(ev.key === 'Backspace'){ expression = expression.slice(0,-1); render(); return; }
        if(ev.key === 'Escape'){ expression=''; render(); return; }
        // allow digits, operators and parentheses and dot
        if(/^[0-9+\-*/().]$/.test(ev.key)){
          expression += ev.key;
          render();
        }
      });

      // initial render
      render();
    })();
  </script></body>
</html>
